---
layout: post
title: npm 패키지 제작기 6
date: '2024-01-05 17:02:45 +0900'
category: [자기계발, npm]
tags: [npm, cli]
---

# CLI 개발
npm 에서 제공하는 모듈들을 사용하다 보면, 단순히 모듈로 사용할 뿐만 아니라 CLI에서 사용할 수 있는 모듈들이 있다.

내가 만든 모듈도 CLI를 사용해보고 싶어서 관련 내용을 찾아보았다.

기본적으로 nodejs의 설치와 함께 path가 설정된다.(nodejs 혹은 nvm 에 맞춘 경로)

해당 path에 내가 만든 모듈의 커맨드를 추가하려면 몇 가지 작업이 필요하다.

1. `package.json`에 관련 설정을 추가한다.
2. 커맨드 관련 스크립트를 작성한다.
3. 모듈을 global로 설치한다.

## package.json
CLI에서 nodejs 모듈을 사용하려면 `package.json`의 `"bin"` 필드에 사용할 스크립트 경로를 명시해줘야 한다.

간단한 예시로 확인해보자. 아래는 내가만든 모듈의 `package.json`을 긁어온 것이다.

```json
{
  "name": "markdown-grouper",
  "version": "1.6.2",
  "description": "package for grouping html parsed from markdown. This package uses header for grouping. You can set class or id for each group, so you can customize css or etc for each group.",
  "bin": {
    "mdg": "./bin/index.mjs"
  },
  "main": "./lib/main.js",
  "exports": {
    ".": {
      "require": {
        "default": "./lib/main.js",
        "types": "./lib/main.d.ts"
      },
      "import": {
        "default": "./lib/main.mjs",
        "types": "./lib/main.d.mts"
      }
    }
  },
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "uglify": "uglifyjs ./lib/main.js ./lib/main.mjs -o ./output/main.js"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/momo1108/markdown-grouper.git"
  },
  "keywords": [
    "markdown",
    "group"
  ],
  "author": "momo1108",
  "license": "ISC",
  "bugs": {
    "url": "https://github.com/momo1108/markdown-grouper/issues"
  },
  "homepage": "https://github.com/momo1108/markdown-grouper#readme",
  "dependencies": {
    "@liquify/prettify": "^0.5.5-beta.1",
    "chalk": "^4.1.2",
    "commander": "^11.1.0",
    "marked": "^11.0.0"
  },
  "devDependencies": {
    "gulp": "^4.0.2",
    "gulp-javascript-obfuscator": "^1.1.6",
    "gulp-rename": "^2.0.0",
    "gulp-uglify": "^3.0.2"
  }
}

```

`"bin"` 필드를 보면 패키지명인 `"markdown-grouper"`는 너무 길어서 Key 부분에 따로 `"mdg"`라고 명시해 두었다.

이렇게 되면 CLI에서 커맨드를 사용할 때 `mdg` 라는 커맨드로 사용이 가능하다.

`mdg` 커맨드가 실행될 경우, 프로젝트의 bin 폴더에 있는 index.mjs 스크립트를 실행하겠다는 뜻이다.

---

## 스크립트 작성
이제 커맨드를 실행하면 실제로 작동할 코드를 작성해야 하는데, Node.js 로 작성하는 가장 기본적인 방법은 process 모듈을 사용해 사용자의 입력값을 사용하는 것이다.

