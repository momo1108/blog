---
layout: post
title: DLL(Dynamic-Link Library)란 무엇인가
date: '2024-02-28 17:45:48 +0900'
category: [Windows, DLL]
tags: [dll,shared library,com]
---

# DLL(Dynamic-Link Library) 이란?
DLL 은 Microsoft Windows 의 shared library 이다. DLL 은 함수, 데이터, 리소스를 조합하여 만들 수 있다.

## 개요
Windows 운영체제의 많은 기능들이 DLL 형태로 제공된다. 또한 Windows 운영체제에서 프로그램을 실행할 때 다양한 기능들을 DLL 로부터 제공받을 수 있다.

예시) 한 프로그램에서 다양한 모듈들을 사용하는데, 각각의 모듈들은 각각의 DLL 들에 포함되어 있다.

이렇게 DLL 을 사용하면 코드의 모듈화, 재사용성, 메모리 효율성, 저장공간 확보 등의 장점을 챙길 수 있어 더 빠른 로딩과 실행, 적은 용량의 디스크에도 저장이 가능해진다.

다만 프로그램에서 DLL 을 사용할 때, *의존성(dependency)* 이라는 개념이 프로그램 오작동을 일으킬 수 있다. 프로그램이 DLL 을 사용하면 프로그램과 DLL 간의 의존성이 생기는데, 만약 다른 프로그램에서 이 의존성을 덮어쓰거나 깨버리면 원래의 프로그램이 오작동할 수 있다.

단 .NET Framework 에서는 대부분의 의존성 문제가 assemblies 를 사용해서 해결되어있다.

## DLL 자세히 살펴보기
DLL 은 코드와 데이터를 가지고 있으며, 여러 프로그램에서 동시에 사용될 수 있다. 간단한 예시로 Windows 운영체제에서 *Comdlg32 DLL* 은 일반 대화상자와 관련된 기능을 수행한다. 모든 프로그램들은 각각 이 DLL 의 기능을 대화상자를 생성하는데 사용할 수 있다. 이런식으로 코드의 재활용과 메모리 효율을 상승시킨다.

DLL 을 사용함으로서 프로그램을 분리된 컴포넌트로 모듈화시킬 수 있다. 예를들어 회계 관련 프로그램이 모듈 형태로 판매될 수 있다. *회계 모듈*을 구매한 회사에서 이 모듈을 설치하고, *메인 프로그램*의 *runtime* 에 모듈을 불러온다. 이렇게 *회계 모듈*이 *메인 프로그램*과 따로 분리되어있기 때문에, 프로그램의 로딩은 더 빨라지고 *회계 모듈*은 기능이 사용될 때만 불러온다.

더불어 기능 등의 다양한 업데이트도 프로그램의 다른 부분에 영향을 주지않는 선에서 각각의 모듈에 쉽게 적용이 가능하다. 예를들어 우리가 급여대장 프로그램을 가진 사장님이면 매년 세금의 변화를 프로그램에 적용해야 한다. 세금처럼 자주 변화하는 내용이 한 DLL 에 따로 분리되어있다면, 관련 변화 내용을 프로그램 전체를 빌드하거나 설치하지 않고도 적용하여 업데이트할 수 있다.